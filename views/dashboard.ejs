<!DOCTYPE html>
<html lang="en">

<head>
	<title></title>
	<meta charset="utf-8" />
	<meta content="width=device-width" name="viewport" />
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker:wght@100;200;300;400;500;600;700;800;900" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<style>

		.button .content,
		.html-block {
			text-align: center
		}

		body {
			background-color: #f1a92b;
			color: #b11616;
			font-family: Arial, "Helvetica Neue", Helvetica, sans-serif
		}

		.row-content {
			display: flex
		}

		.button a,
		.icon .icon-label-right a,
		.menu ul li a {
			text-decoration: none
		}


        .row-1 .col-1 .block-1 h3 {
            color:#b11616;
            direction:ltr;
            font-family:'Permanent Marker', Impact, Charcoal, sans-serif;
            font-size:36px;
            font-weight:400;
            letter-spacing:1px;
            line-height:150%;
            margin-top:0;
            margin-bottom:0;
        }


		.row-1 .col-1 {
			padding: 20px 10px 20px 20px;
			display: flex;
			flex-direction: column;
			justify-content: center;
            width: 40vw;
		}

		.row-1 .col-2 {
			padding-bottom: 20px;
			padding-left: 10px;
			padding-top: 20px;
			display: flex;
			justify-content: right;
            width:70vw;
		}

        .row-1 .col-2 .parallelogram-3d-box .mrvworld {
				width: 320px;
		}
		.row-1 .col-2 .parallelogram-3d-box a {
				position: absolute;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
				color: white;
				font-weight: bold;
				transform: skew(20deg);
                text-decoration: none;
		}
        
        .row-1 .col-2 .parallelogram-3d-box {
				position: relative;
				width: 200px;
				height: 40px;
				background-color: #b11616;
                margin: 10px
		}

        .parallelogram-3d-box {
            transform: skew(-20deg);
            transition: transform 0.3s ease;

        }
		
        .parallelogram-3d-box:hover {
				transform: perspective(500px) translateZ(20px);
		}
		
        .parallelogram-3d-box .front {
				position: absolute;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
				color: white;
				font-weight: bold;
		}

		.mobile-menu {
				display: none;
		}

        .row-2 {
            display: flex;
            justify-content: center;
            height: 30vh;
            margin-bottom: 50px;
        }

        .row-2 .row-content {
            height: 100%;
            display: flex;
            flex-direction: row;
            
        }

		.row-2 .col-1 {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            margin-top: 5px;
            width: auto;
            height: auto;

        }

        .row-2 .col-1 .picture {
            width: 150px; 
            height: 150px; 
            border-radius: 50%;
            background-color: transparent; 
            display: flex; 
            justify-content: center; 
            align-items: flex-start; 
            overflow: hidden;
            border: 2px solid #b11616;
            margin-right: 20px
        }
        .row-2 .col-1 .picture i {
            font-size: 100px; 
            color: #b11616;
            padding: 20px
        }

        .row-2 .col-1 .data {
            width: auto;
            height:auto;
            display: flex;
            flex-direction: column;
            justify-content: top;
        }

        .row-2 .col-1 .data p {
            font-weight: bold;
        }

        .button-logout {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 15px;
        margin-bottom: 10px;
        text-decoration: none;
        }

        .button-logout i {
            color: #b11616;
            font-size:35px;
            text-decoration: none;
        }

        #buttonOpenBuyForm:hover {
            text-decoration: none;
            cursor: pointer;
        }

        .row-2 .col-2 {
            width: 20vw;
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            gap: 80px;
            height: 100%;
            margin-left: 40px;
        }

        .row-2 .col-2 .container-mrvcard {
            margin-right: 10px;
            height: 30%;
        }

        #modalPoints {
            display: none; 
            position: fixed; 
            top: 0;
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.5); 
            justify-content: center; 
            align-items: center;
        }

        #modalPointsContent {
            background-color: white; 
            padding: 20px; 
            border-radius: 10px; 
            max-width: 4000px; 
            width: 500px;
            height: auto;
        }

        .close {
        color: #b11616;
        z-index: 1;
        float: right;
        font-size: 28px;
        font-weight: bold;
        }

        .close:hover,
        .close:focus {
            cursor: pointer;
            text-decoration: none;
        }

        #purchaseSubmitForm {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #b11616; 
            color: white; 
            padding: 20px; 
            border-radius: 10px;
            width: 93%;
            height: 90%;
        }


        .row-2 .col-2 .text-container-mrvcard {
            padding-top: 10px;
            padding-bottom: 10px;
            background-color: #b11616; 
            border: 3px solid #8b0000; 
            border-radius: 10px;
            padding-left: 20px; 
            padding-right: 20px; 
            width: 90%; 
            height: 100%; 
            color: white; 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between;
            align-items: center;
        }

        .row-2 .col-2 p {
            padding: 3px;
            font-weight: bold;
        }

		.row-2 .col-3 {
            display: flex;       
            align-items: center;
            margin-left: 40px;
			width: 40vw;
            height:auto
		}

        .row-2 .col-3 .container-packets {
            height:100%; 
            width: 100%; 
            display: flex;
            justify-content: center;  
            align-items: center;
        }
         
        .packet-box {
            display: flex;
            flex-direction: column;
            justify-content: top;
            margin-top: 5px;
            height:auto;
            width:100%;
            border: 5px solid #b11616;
            border-radius: 15px; 
            color: #b11616
        }

        .packet-header {
            text-align: center;
            padding: 0;
            margin: 0; 
            height:auto;
        }

        .packet-main {
            padding-top: 30px;
            padding-bottom: 30px;
            border-top: 3px solid #b11616;
            border-bottom: 3px solid #b11616;
            height: auto;
            overflow-x: auto;
            scrollbar-width: none; /* For Firefox */
            -ms-overflow-style: none;  /* For Internet Explorer and Edge */
        }

        .packet-main::-webkit-scrollbar {
            display: block; /* For Chrome, Safari, and Opera */
            scrollbar-color: #ffffff;
        }

        .packet-main:hover {
            scrollbar-width:auto; /* For Firefox */
            -ms-overflow-style: auto;  /* For Internet Explorer and Edge */
        }

        .packet-main:hover::-webkit-scrollbar {
            display: block; /* For Chrome, Safari, and Opera */
            height: 8px;
        }

        .packet-main:hover::-webkit-scrollbar-thumb {
            background-color: #b11616;
            border-radius: 4px;
        }

        .packet-main:hover::-webkit-scrollbar-track {
            background-color: #f1a92b;
        }

        .packet-footer {
        font-weight: bold; 
        text-align: center;
        padding: 0;
        margin: 0; 
        height:auto;
        }



        @media (max-width: 856px) {
    .row-1 {
        display: none;
    }

    .mobile-menu {
        display: block;
    }

    .mobile-menu-icon {
        font-size: 24px;
        cursor: pointer;
        padding: 10px;
    }

    .mobile-menu-content {
        display: none;
        background-color: #b11616;
        color: #ffffff;
        padding: 10px;
    }

    .mobile-menu-content.show {
        display: block;
        gap: 10px
    }
    
    .mobile-menu-content .mobile-menu-row {
        border-bottom: 1px solid #ffffff;
        padding: 5px
    }

    .mobile-menu-content .mobile-menu-row a {
        color: #ffffff;
    }

    .row-2 {
        flex-direction: column;
        align-items: center;
        width: 100vw;
    }

    .row-2 .row-content {
        flex-direction: column;
        width: 100%;
    }


    .row-2 .col-1 {
        flex-direction: column;
        align-items: center;
    }

    .row-2 .col-1 .picture {
        width: 80%;
        margin-right: 0;
        margin-bottom: 20px;
    }

    .row-2 .col-1 .data {
        width: 100%;
        align-items: center;
    }

    .row-2 .col-2 {
        margin-left: 0;
    }

    .row-2 .col-2 .container-mrvcard {
        width: 100%;
        margin-right: 0;
    }

    .row-2 .col-3 {
        margin-left: 0;
    }

    .packet-box {
        width: 100%;
    }
}



	</style>
</head>

<body>
	<div class="page-container">
		<div class="row row-1">
			<div class="row-content">
				<div class="col col-1 ">
					<div class="block block-1 title"> 
                        <h3> See Heroes </h3> 
                    </div>
				</div>
				<div class="col col-2 ">
					<div class="container col-2">
                        <div class="parallelogram-3d-box market"> 
                            <a href="/marketplace">Marketplace</a>
                        </div>
                        <div class="parallelogram-3d-box mrvworld"> 
                            <a href="/mrvworld">Marvel World News</a>
                        </div>
                        <div class="parallelogram-3d-box faq"> 
                            <a href="/faq">FAQs</a>
                        </div>
                    </div>
				</div>
            </div>
		</div>

        <div class="mobile-menu">
            <div class="mobile-menu-icon" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </div>
            <div class="mobile-menu-content">
                <div class="mobile-menu-row mobile-row-1">
                    <a href="/marketplace"> Marketplace </a>
                </div>
                    <br>
                <div class="mobile-menu-row mobile-row-3">
                    <a href="/mrvworld"> Marvel World News </a>
                </div>
                    <br>
                <div class="mobile-menu-row mobile-row-4">
                    <a href="/faq"> FAQs </a>
                </div>
            </div>
        </div>

        <script>
            function toggleMobileMenu() {
                const mobileMenuContent = document.querySelector('.mobile-menu-content');
                mobileMenuContent.classList.toggle('show');
            }
        </script>


		<div class="row row-2" >
			<div class="row-content">

				<div class="col col-1 profile">
                    <div class="block block-1">
                        <div class="block picture" >
                            <i class="fas fa-user"></i>
                        </div>
                        <a href="/account/logout" class="button-logout"><i class="fas fa-sign-out-alt"></i></a>	
                    </div>
					<div class="block block-2 data">
                        <p><%= user_profile.name %></p>
                        <p><%= user_profile.username %></p>
                        <p><%= user_profile.email %></p>
                        <br>
                        <div class="edit-button">
                            <a href="/dashboard/edit" style="display: inline-block; padding: 10px 20px; background-color: #b11616; color: white; text-decoration: none; border-radius: 25px; border: 2px solid #8b0000; font-weight: bold;">Edit Profile</a>
                        </div>
                    </div>
				</div>
				
				<div class="col col-2 mrvcard">
					<div class="container-mrvcard">
                        <div class="text-container-mrvcard" style="height:auto; display: flex; flex-direction: column; justify-content: center;">
                            <h3 style="text-align: left; margin: 0;"> <%= user_profile.username %>'s Marvel Card</h3>
                            <br>
                            <h3 style="text-align: left; margin: 0;">Points: <%= user_profile.points %></h3>
                            <br>
                            <p style="text-align: left; margin: 0;">Date Created: <%= user_profile.createdAt %></p>                       
                        </div>
                    </div>
                    <div class="button-buypoints" style="margin-top: 20px;">
                        <a onclick="openBuyForm()" id="buttonOpenBuyForm" style="padding: 10px 20px; background-color: #b11616; color: white; text-decoration: none; border-radius: 25px; font-weight: bold; border: 2px solid #8b0000;">Buy Points</a>
                    </div>
                        <div id="modalPoints">
                            <div id="modalPointsContent">
                                <span onclick="document.getElementById('modalPoints').style.display='none'; document.getElementById('purchaseSubmitForm').reset(); document.getElementById('totalCost').innerHTML = 'Total Cost: 1 €'; " id="buttonOpenBuyForm" class="close" style="position: relative; color: #b11616; font-size: 36px; cursor: pointer; display: block;">&times;</span>
                                <form id="purchaseSubmitForm" style="position: relative; padding-top: 30px;">
                                    <select id="amount" name="amount" style="width: 100%; margin-bottom: 10px; background-color: white; color: #b11616; border: 2px solid #b11616; border-radius: 25px; padding: 5px;" onchange="updateTotalCost()">
                                        <% for (let i = 1; i <= 100; i++) { %>
                                            <option value="<%= i %>"><%= i %> points</option>
                                        <% } %>
                                    </select>
                                    <br>
                                    <label id="totalCost">Total Cost: 1€</label>
                                    <br>
                                    <script>
                                        function updateTotalCost() {
                                            var amount = document.getElementById('amount').value;
                                            document.getElementById('totalCost').innerHTML = 'Total Cost: ' + amount + '€';
                                        }
                                    </script>
                                    <input type="submit" value="Purchase" style="width: 100%; margin-top: 10px; padding: 10px; background-color: white; color: #b11616; border: 2px solid #b11616; border-radius: 25px; cursor: pointer;">
                                </form>
                            </div>
                        </div>
				</div>				
                
                <div class="col col-3 packets">
					<div class="container-packets">
						<div class="packet-box">
                            <div class="packet-header">
                                <p style="font-weight: bold;">Your Packets</p>
                            </div>
                            <div class="packet-main" style="overflow-x: auto;">
                                <ul class="packet-list" style=" list-style-type: none; padding: 0; display: flex; justify-content: space-around; align-items: center; height: 50px">
                                    <% user_packets.forEach(function(packet) { %>
                                    <li style="margin-right: 40px; margin-left: 10px">
                                        <a id="button-openpacket" onclick="openPacket(this)" style="cursor: pointer;">
                                            <svg width="70" height="100" viewBox="0 0 70 100" data-key="<%= packet.id %>">
                                                <defs>
                                                    <pattern id="stripes" patternUnits="userSpaceOnUse" width="10" height="10">
                                                        <rect width="10" height="5" fill="#b11616"/>
                                                        <rect width="10" height="5" y="5" fill="#8b0000"/>
                                                    </pattern>
                                                </defs>
                                                <path d="M0,6.25 L5.83,0 L11.67,6.25 L17.5,0 L23.33,6.25 L29.17,0 L35,6.25 L40.83,0 L46.67,6.25 L52.5,0 L58.33,6.25 L64.17,0 L70,6.25 V93.75 L64.17,100 L58.33,93.75 L52.5,100 L46.67,93.75 L40.83,100 L35,93.75 L29.17,100 L23.33,93.75 L17.5,100 L11.67,93.75 L5.83,100 L0,93.75 Z" fill="url(#stripes)" stroke="#000000"/>
                                            </svg>
                                        </a>
                                    </li>
                                    <% }); %>
                                </ul>							
                            </div>
                            <div class="packet-footer" style="display:flex; justify-content: center; padding: 20px;">
                                <a style="text-decoration: none; color: white" href="/account/dashboard/buypackets" style="margin: 0; color: white;">
                                    <div style="width:200px; background-color: #b11616; border: 2px solid #8b0000; border-radius: 25px; padding: 10px;">
                                        <span>Buy packets</span>
                                    </div>
                                </a>
                            </div>
						</div>
                        <div id="modalPacket" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
                            <div id="modalPacketsContent" style="background-color: #b11616; border: 3px solid #8b0000; border-radius: 15px; width: 80%; max-width: 800px; height: 60%;">
                                <div style="height: 50px; display: flex; justify-content: center; align-items: center; border-bottom: 1px solid #8b0000;">
                                    <p style="margin: 0; color: white; font-weight: bold;">Figurines</p>
                                </div>
                                <div style="height: calc(100% - 100px); display: flex; justify-content: space-evenly; align-items: center; padding: 20px 0;">
                                    <img src="/path/to/image1.jpg" style="max-height: 80%; width: auto;">
                                    <img src="/path/to/image2.jpg" style="max-height: 80%; width: auto;">
                                    <img src="/path/to/image3.jpg" style="max-height: 80%; width: auto;">
                                    <img src="/path/to/image4.jpg" style="max-height: 80%; width: auto;">
                                    <img src="/path/to/image5.jpg" style="max-height: 80%; width: auto;">
                                </div>
                                <div style="height: 50px; display: flex; justify-content: center; align-items: center; border-top: 1px solid #8b0000;">
                                    <a href="/account/dashboard" style="text-decoration: none; color: white;">
                                        <div>
                                            <p style="margin: 0;">Return to Dashboard</p>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <script>
                        document.getElementById('button-openpacket').addEventListener('click', function() {
                        document.getElementById('modalPacket').style.display = 'flex';
                        });
                        </script>
                        
                    </div>
				</div>
			</div>



		</div>
		<div class="row row-3">
			<div class="row-content">
				<div class="col col-1 ">
				
				</div>
				<div class="col col-2 ">
					
				</div>
			</div>
		</div>

		<div class="row row-4">
			<div class="row-content">
				<div class="col col-1 ">

				</div>
				<div class="col col-2 ">
				
				</div>
			</div>
		</div>
	</div>

    <script>
        function openBuyForm() {
            const modal = document.getElementById('modalPoints');
            const moadlContent = document.getElementById('modalPointsContent');
            const purchaseForm = document.getElementById('purchaseSubmitForm');

            modal.style.display = "flex";

            purchaseForm.addEventListener('submit', function(event) {

                event.preventDefault();

                const updatedData = {
                    pointsAmount: document.getElementById('amount').value
                }

                fetch('/account/dashboard/buypoints/confirm', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updatedData)
                })
                    .then(response => response.json())
                        .then((data) => {
                            if(data.success) {
                                purchaseForm.reset();
                                document.getElementById('totalCost').innerHTML = 'Total Cost: 1 €';
                                modal.style.display = 'none';
                            }
                            else {
                                alert('error adding points');
                            }
                        })
                        .catch((error) => {
                        console.error('Error:', error);
                        });
            });
        }


        function openPacket(a_container) {
            const packet_id = this.children[0].getAttribute('data-key');

            fetch('/account/dashboard/packets/' + packet_id)
                .then((response) => {
                    /* server returns data that's used to render the opening packet box*/


                })


        }
    </script>
</body>

</html>